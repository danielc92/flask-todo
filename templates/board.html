{% extends 'base.html' %}
{% block content %}
<section class="section">
    <section class="container">
        <article class="content">
            <h1>Dashboard</h1>

                <p>Monitor your progress, view workflow stats, create and manage your tasks.</p>
                <article class="message is-warning">
                    <div class="message-body is-italic">{{ quote['quote'] }} <strong> - {{ quote['name'] }}</strong></div>
                </article>

            <section class="columns">
                {% set tasks_total = tasks_complete|length + tasks_incomplete|length%}
                <article class="column">
                    <div style="height:100%;" class="notification is-primary has-text-centered">
                        <h1 class="has-text-white">{{ tasks_complete|length }}</h1>
                        <p>Completed Tasks</p>
                    </div>      
                </article>

                <article class="column">
                    <div style="height:100%;" class="notification is-primary has-text-centered">
                        <h1 class="has-text-white">{{ tasks_incomplete|length }}</h1>
                        <p>Incomplete Tasks</p>
                    </div>      
                </article>

                <article class="column">
                    <div style="height:100%;" class="notification is-primary has-text-centered">
                        <h1 class="has-text-white">{{ tasks_total }}</h1>
                        <p>Total Tasks</p>
                    </div>      
                </article>

                <article class="column">
                    <div style="height:100%;" class="notification is-primary has-text-centered">
                        {% if tasks_total == 0 %}
                            <h1 class="has-text-white">-</h1>
                        {% else %}
                            <h1 class="has-text-white">{{ '{0:0.0%}'.format(tasks_complete|length / tasks_total) }}</h1>
                        {% endif %}
                        <p>Completion Rate</p>
                    </div>      
                </article>
            </section>
            
            <h1 id="piles">Workflow</h1>
            <section class="columns">
                <article class="column">
                    <h3>Create a task</h3>
                    <form class="form" method="post">
                        <div class="field">
                            <label class="label">Name</label>
                            <input required name="task-name" type="text" class="input" placeholder="Important Meeting"></input>
                        </div>
                        <div class="field">
                            <label class="label">Description</label>
                            <textarea class="textarea" rows="2" required name="task-desc" type="text" class="input" placeholder="Discuss bar chart to stakeholders."></textarea>
                        </div>
                        <div class="field">
                            <label class="label">Value</label>
                            <textarea rows="2" class="textarea" required name="task-value" type="text" class="input" placeholder="Increases understanding of data."></textarea>
                        </div>
                        <div class="field">
                            <button class="button is-primary">Create task</button></div>
                    </form>

                </article>
                <article class="column">
                    <h3>In Progress</h3>
                        {% if tasks_incomplete|length < 1 %}
                        <p>You have no tasks, you can create one in the left panel.</p>
                        {% endif %}

                        {% for d in tasks_incomplete %}
                                <article class="message is-info">
                                    <div class="message-body">
                                        {% include 'task-template.html' %}
                                        <p><a class="is-fullwidth button is-link is-normal" href="{{ url_for('update_task', status='complete', uuid=d['uuid']) }}">Mark this task as complete</a></p>
                                    </div>
                                </article>
                        {% endfor %}
                </article>
                <article class="column">
                    <h3>Finished</h3>
                        
                        {% if tasks_complete|length < 1 %}
                            <p>You have not completed any tasks so far.</p>
                        {% endif %}

                        {% for d in tasks_complete %}
                                <article class="message is-primary">
                                    <div class="message-body">
                                        {% include 'task-template.html' %}
                                    </div>
                                </article>
                        {% endfor %}
                </article>
            </section>
        </article>
    </section>
</section>
{% endblock %}